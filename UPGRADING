General upgrade instructions
============================

1) Follow specialized upgrade instructions in the sections below

2) Install the new version of RTIR. (DO NOT RUN "make initdb")

3) Update RTIR's database.
    
   Type:

        ls etc/upgrade

    For each item in that directory whose name is greater than
    your previously installed RT version, run:
    
        /opt/rt3/sbin/rt-setup-database --dba <dba> \
            --prompt-for-dba-password --action schema \
            --datadir etc/upgrade/<version>
        /opt/rt3/sbin/rt-setup-database --dba <dba> \
            --prompt-for-dba-password --action insert \
            --datadir etc/upgrade/<version>


Follow instructions from previous "upgrading from" sections at
the end of this document if they apply to your installation.

Upgrading from RTIR 1.1.5
-------------------------

1) The LaunchMessage template in the Investigations queue
has been renamed into Autoreply without any changes of the content.
This upgrade step is automated, but may fail if you've changed
the LaunchMessage template.

2) In the Blocks queue an Autoreply template is adde. This is
replacement the NewMessage template. Automated step doesn't delete
old template, you have to check that the new template suites your
needs and may be copy customizations from the old one, then delete
the NewMessage template.

3) A new template has been added - 'BlockRemoved' in the Blocks
queue. Check its content.

4) NotifyOnLaunch and NotifyOnCreate scrips have been deleted in
the Implementations and the Blocks queues respectively. You have to
use the default RT's Autoreply scrip instead or create autoreply
scrips in these queues.

Upgrading from RTIR 1.1.3
-------------------------

1) Delete the following Scrips (go to Configuration / Queues / <Queue
Name> / Scrips):

In the Incidents Queue:
  SetStartsDate
  SetRTIRState
  ResolveAllChildren
  FixOwnership

In the Incident Reports Queue:
  DetectUserResponse 
  SetDue             
  SetStarts          
  UnsetDue           
  SetDueReopen       
  SetHowReported     
  SetRTIRState       
  FixOwnership       
  ReopenIncident

In the Investigations Queue:
  NotifyOnLaunch
  DetectUserResponse
  SetStarts
  SetDue
  UnsetDue
  SetDueReopen
  SetRTIRState
  FixOwnership
  ReopenIncident

In the Blocks Queue:
  NotifyOnCreate
  DetectUserResponse
  SetStarts
  SetDue
  UnsetDue
  UnsetDue
  SetDueReopen
  SetRTIRState
  FixOwnership
  ReopenIncident

2) Run the etc/upgrade/upgrade.pl script.

This script updates Due Dates on all incidents and set to the most
recent due date of the children. 

NOTE that script use hardcoded path '/opt/rt3', if your RT server installed
into different location you should change it.


Upgrading from RTIR 1.1.2:
--------------------------

1) Delete the "SetDueReopen" scrip from the Incident Reports,
   Investigations, and Blocks queues.

Upgrading from RTIR 1.0.0:
--------------------------

RTIR now installs in RT's share/html directory rather than local/html,
making local modifications to RTIR easier.

1) IMPORTANT!  Back up any modifications that you've made to the
   /opt/rt3/local/html/RTIR directory.

2) Remove the old RTIR files:

   rm -r /opt/rt3/local/html/RTIR

