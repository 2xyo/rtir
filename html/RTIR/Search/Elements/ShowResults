<& /Elements/TicketList, 
    RTIRCheck => $RTIRCheck,
    Query => $Query,
    AllowSorting => 1,
    OrderBy => $OrderBy,
    Order => $Order,
    Rows => $Rows,
    Page => $Page,
    Format => $Format,
    BaseURL => $BaseURL,
    ShowNavigation => 0
   &>

<div align="right">

% if ($Queue eq 'Incident Reports') {
%# this would do well as a Callback
<a href="<%$RT::WebPath%>/RTIR/Report/BulkReject.html<%$QueryString%>&Queue=<%$Queue%>"><&|/l&>Bulk Reject</&></a><br>
% }

%if (0) {
<a href="<%$BaseURL%><%$QueryString%>&Queue=<%$Queue|u%>"><&|/l&>Bookmarkable link</&></a><br>
<a href="<%$RT::WebPath%>/Search/Results.tsv?Queue=<%$Queue%><%$QueryString%>"><&|/l&>spreadsheet</&></a> |
<a href="<%$RT::WebPath%>/Search/Results.rdf?Queue=<%$Queue%><%$QueryString%>"><&|/l&>RSS</&></a> |

% }
</div>

<%INIT>
$session{'i'}++;
$session{'tickets'} = RT::Tickets->new($session{'CurrentUser'})  unless ($session{'tickets'});
$session{'tickets'}->FromSQL($Query) if ($Query);
$session{'tickets'}->OrderBy(FIELD => $OrderBy, ORDER => $Order); 

if ($OrderBy ne $session{'CurrentSearchHash'}->{'OrderBy'}
    or $Order ne $session{'CurrentSearchHash'}->{'Order'}) {
    $session{'CurrentSearchHash'}->{'OrderBy'} = $OrderBy;
    $session{'CurrentSearchHash'}->{'Order'}   = $Order;
    # Invalidate the ordering cache
    undef $session{'tickets'}->{'items_array'};
}
</%INIT>

<%ARGS>
$Query => undef
$Format => undef 
$HideResults => 0
$Rows => 50
$Page => 1
$OrderBy => 'id'
$Order => 'ASC'
$QueryString => undef
$Queue => undef
$BaseURL => $RT::WebPath."/Search/Results.html?"
$RTIRCheck => undef
</%ARGS>
